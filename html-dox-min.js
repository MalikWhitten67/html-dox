let e,t,r=[],n=document.querySelector("imports"),o=document.querySelector("[imports]");if(o)t=o.getAttribute("imports").replace(/\s/g,"");else if(n)throw new Error('<imports> is deprecated use <meta imports="/someimport,/someimport"> instead! read latest git release for more info: https://github.com/MalikWhitten67/html-dox/releases/latest');if(!(t.length>0))throw new Error('No imports found! Please add <meta imports="/someimport,/someimport"> to your html file');t=t.split(","),t=t.filter(Boolean);let i={},a=[],s={"dox:string":String,"dox:number":Number,"dox:boolean":Boolean,"dox:array":Array,"dox:object":Object,"dox:undefined":void 0,"dox:null":null,"dox:function":Function,"dox:regexp":RegExp,"dox:date":Date},l=sessionStorage.getItem("$dox-props")?JSON.parse(sessionStorage.getItem("$dox-props")):{};function c(e){return new Promise((t=>{if(document.querySelector(e))return t(document.querySelector(e));const r=new MutationObserver((n=>{document.querySelector(e)&&(t(document.querySelector(e)),r.disconnect())}));r.observe(document.body,{childList:!0,subtree:!0})}))}const u=async t=>{let n=(new DOMParser).parseFromString(t,"text/html");n=n.body;let o=document.body,i=n.querySelector("export");i&&(i.style.display="none"),n.querySelectorAll("var").forEach((e=>{e.style.display="none";let t=e.getAttribute("name"),r=e.innerHTML.replace(/\s/g,"");if(window[t]=r,e.html,window[t+"Element"]=e,e.hasAttribute("state")){let t=e.getAttribute("state");null!=h(t)&&null!=h(t)||p(t,""),m(t,(t=>{setTimeout((()=>{e.innerHTML=t}),0)}))}n.querySelectorAll("*").forEach((n=>{let o=n.innerHTML.match(/{{(.*?)}}/g),i=n.outerHTML.match(/{{(.*?)}}/g);n.innerHTML;i?i.forEach((e=>{e.split("{{")[1].split("}}")[0]==t&&n.parentNode&&(n.outerHTML=n.outerHTML.replace(e,r))})):o&&n.innerHTML.includes(`{{${t}}}`)?o.forEach((t=>{window.onmessage=t=>{if(t.origin==window.location.origin&&"setVar"==t.data.type){let r=t.data.name,n=t.data.value;e.getAttribute("name")==r&&(window[r]=n,e.innerHTML=n)}},n.innerHTML=n.innerHTML.replace(t,JSON.parse(e.innerHTML))})):window.onmessage=t=>{if(t.origin==window.location.origin&&"setVar"==t.data.type){let r=t.data.name,n=t.data.value;e.getAttribute("name")==r&&(window[r]=n,e.innerHTML=n)}}})),e.remove()})),window.setData=async function(e){let t=(e=e.body).querySelectorAll("var");for(const r of t){r.style.display="none";let t=r.getAttribute("name"),n=r.innerHTML.replace(/\s/g,"");if(window[t]=n,r.html,window[t+"Element"]=r,r.hasAttribute("state")){let e=r.getAttribute("state");null!=h(e)&&null!=h(e)||p(e,""),m(e,(e=>{setTimeout((()=>{r.innerHTML=e}),0)}))}for(const o of e.querySelectorAll("*")){let e=o.innerHTML.match(/{{(.*?)}}/g),i=o.outerHTML.match(/{{(.*?)}}/g);o.innerHTML;if(i)for(const e of i){e.split("{{")[1].split("}}")[0]==t&&o.parentNode&&(o.outerHTML=o.outerHTML.replace(e,n))}else if(e&&o.innerHTML.includes(`{{${t}}}`))for(const t of e)window.onmessage=e=>{if(e.origin==window.location.origin&&"setVar"==e.data.type){let t=e.data.name,n=e.data.value;r.getAttribute("name")==t&&(window[t]=n,r.innerHTML=n)}},o.innerHTML=o.innerHTML.replace(t,JSON.parse(r.innerHTML));else window.onmessage=e=>{if(e.origin==window.location.origin&&"setVar"==e.data.type){let t=e.data.name,n=e.data.value;r.getAttribute("name")==t&&(window[t]=n,r.innerHTML=n)}}}r.remove()}for(const t of e.querySelectorAll("*"))if(t.hasAttribute("props")){let e=t.getAttribute("props").split(":");for(const n of e)if("children"===n){if(t.querySelector("slot")&&t.innerHTML.includes("{{children}}")){let e=t.querySelector("slot").innerHTML;t.innerHTML=t.innerHTML.replace("{{children}}",e)}}else{let e=t.innerHTML.match(new RegExp(`{{${n}}}`,"g"));if(e)for(const o of e)r.forEach((e=>{let r=(new DOMParser).parseFromString(e.template,"text/html");if(r.querySelector(`[${n}]`)){let e=r.querySelector(`[${n}]`).getAttribute(n);t.innerHTML=t.innerHTML.replace(o,e)}}))}}},i&&(i=i.innerHTML.replace(/\s/g,""),i=i.split(","),i=i.filter(Boolean),i.forEach((async t=>{function i(e){e.inject=t=>(e.innerHTML=t,i(e));let t=sessionStorage.getItem("$dox-props")?JSON.parse(sessionStorage.getItem("$dox-props")):[];return t=t[e.tagName],t&&(e.props=t),e.class=t=>(e.className=t,i(e)),e.add=(t,r)=>{let n=document.createElement(t);return r&&Object.keys(r).forEach((e=>{n.setAttribute(e,r[e])})),e.appendChild(n),i(n)},e.delete=()=>(e.remove(),i(e)),e.parent=()=>i(e.parentNode),e.query=e=>{let t=document.querySelector(e);if(t)return i(t)},e.classes=(t,r)=>("add"==r&&e.classList.add(t),"remove"==r&&e.classList.remove(t),"toggle"==r&&e.classList.toggle(t),i(e)),e.html=t=>t?(e.innerHTML=t,i(e)):e.innerHTML,e.prepend=t=>(e.innerHTML=t+e.innerHTML,i(e)),e.append=t=>(e.innerHTML+=t,i(e)),e.blur=()=>{e.blur()},e.fade=t=>{e.style.transition=`opacity ${t}s`,e.style.opacity=0},e.focus=e.focus,e.queryAll=t=>{let r=e.querySelectorAll(t);return e.forEach=e=>{r.forEach((t=>{e(t)}))},r.forEach((e=>{e=i(e)})),r},e.after=t=>(e.insertAdjacentHTML("afterend",t),i(e)),e.before=t=>(e.insertAdjacentHTML("beforebegin",t),i(e)),e.attr=(t,r)=>r?(e.setAttribute(t,r),i(e)):e.getAttribute(t),e.replace=(t,r)=>{let n=document.createElement(t);return n.innerHTML=r,e.parentNode.replaceChild(n,e),i(n)},e.on=(t,r)=>{e.addEventListener(t,(t=>(Object.defineProperty(t,"target",{value:i(t.target)}),Object.defineProperty(t,"currentTarget",{value:i(t.currentTarget)}),r(t),i(e))))},e.setProp=(t,r)=>{if(r)return n.querySelector(e.tagName).setAttribute(t,r),i(e)},e.css=(t,r)=>r?(e.style[t]=r,i(e)):e.style[t],e.getChildren=()=>{let t=[],r=e=>{let n=e.children;for(let o=0;o<n.length;o++)n[o]=i(n[o]),n[o].parent=e,n[o].index=o,t.push(n[o]),r(n[o])};return e.forEach=r=>(t.forEach((e=>{r(e)})),i(e)),e.map=(r,n)=>(n?t.forEach((e=>{r(e,n)})):t.forEach((e=>{r(e)})),i(e)),r(e),t},e}e={route:()=>window.currentRoute,currentRender:()=>{},setProp:(e,t,r)=>{let o=n.querySelector(e);return o&&o.setAttribute(t,r),i(o)},setVar:(e,t)=>{window[e]=t,window.postMessage({type:"setVar",name:e,value:t},window.location.origin)},current:()=>{let e=document.activeElement;if(e)return e.isActive=!0,i(e)},domChange:(e,t=!1,r=(()=>{}))=>{var n=!1;new MutationObserver((function(t){n&&"changed"===e?t.forEach((function(e){r(e)})):r()})).observe(document,{childList:!0,subtree:!0}),setTimeout((()=>{n=!0,t&&r()}),100)},add:(e,t)=>{let r=document.createElement(e);return Object.keys(t).forEach((e=>{r.setAttribute(e,t[e])})),r=i(r),i(r)},title:e=>{document.title=e},querySelector:e=>c(e).then((e=>i(e))),querySelectorAll:e=>c(e).then((t=>{let r=document.querySelectorAll(e);return r.forEach((e=>{e=i(e)})),r})),html:document.querySelector("html").innerHTML,text:document.querySelector("html").innerText,on:(e,t)=>{window.addEventListener(e,t)},post:(e,t,r,n)=>{"object"==typeof t?(t=JSON.stringify(t),fetch(e,{method:"POST",headers:{"Content-Type":"application/json",headers:n},body:t}).then((e=>"json"==n.responseType?e.json():e.text()))):"string"==typeof t?fetch(e,{method:"POST",headers:{"Content-Type":"text/plain",headers:n},body:t}).then((e=>"json"==n.responseType?e.json():e.text())).then((e=>{r(e)})):JSON.parse(t)&&fetch(e,{method:"POST",headers:{"Content-Type":"application/json",headers:n},body:JSON.stringify(t)}).then((e=>e.json())).then((e=>{r(e)}))},get:(e,t,r)=>{fetch(e,{method:"GET",headers:{"Content-Type":"application/json",headers:r}}).then((e=>e.json())).then((e=>{t(e)}))},put:(e,t,r,n)=>{fetch(e,{method:"PUT",headers:{"Content-Type":"application/json",headers:n},body:JSON.stringify(t)}).then((e=>e.json())).then((e=>{r(e)}))},delete:(e,t,r)=>{fetch(e,{method:"DELETE",headers:{"Content-Type":"application/json",headers:r}}).then((e=>e.json())).then((e=>{t(e)}))},setMeta:(e=null,t=null,r,n=!1,o=!1)=>{if(t){if(o&&(r.includes("https")||r.includes("http")))return void(r+="?a=b");if(document.querySelector(`meta[property="${t}"]`))return document.querySelector(`meta[property="${t}"]`).setAttribute("content",r),void(n&&document.querySelector(`meta[property="${t}"]`).setAttribute(n,r));{let i=document.createElement("meta");if(o&&(r.includes("https")||r.includes("http")))return void(r+="?a=b");n&&Object.keys(n).forEach((e=>{cosole.log(e),i.setAttribute(e,n[e])})),i.setAttribute("property",t),i.setAttribute("content",r),e&&i.setAttribute("name",e),document.querySelector("head").appendChild(i)}}else if(e){let t=document.createElement("meta");t.setAttribute("name",e),t.setAttribute("content",r),n&&Object.keys(n).forEach((e=>{t.setAttribute(e,n[e])})),document.querySelector("head").appendChild(t)}}},window.dox=e;let u=n.querySelector(t);[].forEach((e=>{if(u.hasAttribute(e)&&"typeof"===e){let r=a.find((t=>t.name===u.getAttribute(e)));if(!r)throw new Error(`Type "${u.getAttribute(e)}" does not exist`);{let e,n=s[r.constraint],i=o.querySelector(t).innerHTML;if("false"===r.isStrict)return;if(n===Number){if(e=Number(i),e=isNaN(e)?0:e,0===e)throw new Error(`Invalid value for type "${r.name}": ${i} (expected number)`)}else if(n===Boolean)if("true"===i.toLowerCase())e=!0;else{if("false"!==i.toLowerCase())throw new Error(`Invalid value for type "${r.name}": ${i} (expected boolean)`);e=!1}else{if(n!==String)throw new Error(`Invalid constraint type for type "${r.name}": ${r.constraint}`);e=i}}}}));n.querySelectorAll("[state]").forEach((e=>{let t=e.getAttribute("state");e.id=t,null!=h(t)&&null!=h(t)||p(t,""),e.innerHTML=e.innerHTML+h(t),setTimeout((()=>{m(t,(r=>{setTimeout((()=>{"INPUT"!=e.tagName&&"TEXTAREA"!=e.tagName||(e.value=r),"SELECT"==e.tagName&&(e.value=r),"IMG"==e.tagName&&(e.src=r),"A"==e.tagName&&(e.href=r),"IFRAME"==e.tagName&&(e.src=r),"VIDEO"==e.tagName&&(e.src=r),"AUDIO"==e.tagName&&(e.src=r),"EMBED"==e.tagName&&(e.src=r),"OBJECT"==e.tagName&&(e.src=r),"SOURCE"==e.tagName&&(e.src=r),"TRACK"==e.tagName?e.src=r:e.innerHTML=r,document.querySelector(`#${t}`).innerHTML=r}),0)}))}),0)})),n.querySelectorAll("*").forEach((async e=>{if(e.innerHTML.includes("{{")){e.innerHTML.match(/{{(.*?)}}/g),e.innerHTML;let t=e.innerHTML.match(/{{(.*?)}}/gs);t&&t.forEach((async e=>{let t=e.split("{{")[1].split("}}}")[0].trim();if(t.startsWith("map(")&&t.endsWith("}}")){e=e.replace("&gt;",">");let n=t.split("map(")[1].split(")")[0],o=e.split("return(")[1].split("){")[0].trim(),i=e.split("){")[1].trim().split("}}")[0].trim();i=i.replace(/json\./g,"");let a=document.createElement("div");async function r(e){let t,r;if(e&&e.data&&e.data.name==n){a.innerHTML="",t=e.data.name,r=e.data.value,parsed=JSON.parse(JSON.stringify(window[t]));let l,c;function s(e){return new Promise((t=>{if(document.querySelector(e))return t(document.querySelector(e));const r=new MutationObserver((n=>{document.querySelector(e)&&(t(document.querySelector(e)),r.disconnect())}));r.observe(document.body,{childList:!0,subtree:!0})}))}o.length>0?(l=new Function("json",`return ${n}.${o}`),c=l(parsed)):c=parsed,c.forEach((e=>{let t,r=i;Object.entries(e).forEach((([e,t])=>{r=r.replace(new RegExp(`{${e}}`,"g"),t)})),t=r,a.innerHTML=a.innerHTML+t}));let u=await s(`[map="${n}"]`);if(u){let d=document.createElement("div");d.innerHTML=a.innerHTML,d.setAttribute("container-map",n),u.querySelector(`[container-map="${n}"]`)?u.querySelector(`[container-map="${n}"]`).innerHTML=a.innerHTML:u.innerHTML=u.innerHTML+d.innerHTML}document.body.innerHTML=document.body.innerHTML.replace(/{{(.*?)}}/gs,""),document.body.innerHTML.includes("}")&&(document.body.innerHTML=document.body.innerHTML.replace(/}/g,""))}else if(n==t||window[n]){a.innerHTML="";let p,h,m=JSON.parse(window[n]);function s(e){return new Promise((t=>{if(document.querySelector(e))return t(document.querySelector(e));const r=new MutationObserver((n=>{document.querySelector(e)&&(t(document.querySelector(e)),r.disconnect())}));r.observe(document.body,{childList:!0,subtree:!0})}))}o.length>0?(p=new Function("json",`return ${n}.${o}`),h=p(m)):h=m,h.forEach((e=>{let t,r=i;Object.entries(e).forEach((([e,t])=>{r=r.replace(new RegExp(`{${e}}`,"g"),t)})),t=r,a.innerHTML=a.innerHTML+t}));let f=await s(`[map="${n}"]`);if(f){let w=document.createElement("div");w.innerHTML=a.innerHTML,w.setAttribute("container-map",n),f.querySelector(`[container-map="${n}"]`)?f.querySelector(`[container-map="${n}"]`).innerHTML=a.innerHTML:f.innerHTML=f.innerHTML+w.innerHTML}document.body.innerHTML=document.body.innerHTML.replace(/{{(.*?)}}/gs,""),document.body.innerHTML.includes("}")&&(document.body.innerHTML=document.body.innerHTML.replace(/}/g,""))}}document.body.innerHTML=document.body.innerHTML.replace(/{{(.*?)}}/gs,""),r(),window.addEventListener("message",(e=>{e.origin==window.location.origin&&"setVar"==e.data.type&&r(e)}))}}))}}));n.querySelectorAll("import");if(n.querySelector(t).hasAttribute("props")){n.querySelector(t);let e=n.querySelector(t).getAttribute("props").split(":");e.forEach((r=>{if(l[t]=e,sessionStorage.setItem("$dox-props",JSON.stringify(l)),u.querySelectorAll("[derive]").forEach((e=>{let r=e.getAttribute("derive"),n=o.querySelector(t).getAttribute(r);e.innerHTML.includes(`{{${r}}}`)&&(e.innerHTML=e.innerHTML.replace(`{{${r}}}`,n))})),"children"==r){if(n.querySelector(t).querySelector("slot")&&n.querySelector(t).innerHTML.includes("{{children}}")){let e=n.querySelector(t).querySelector("slot").innerHTML;n.querySelector(t).innerHTML=n.querySelector(t).innerHTML.replace("{{children}}",e)}}else o.querySelector(t).getAttribute(r)&&(n.querySelector(t).innerHTML=n.querySelector(t).innerHTML.replace(`{{${r}}}`,o.querySelector(t).getAttribute(r)))}))}document.querySelector(t)&&r.push({element:document.querySelector(t),parent:document.querySelector(t).parentNode,template:u.innerHTML,html:n,file:t,body:o,imports:n.querySelectorAll("import")})}))),n.querySelectorAll("type").forEach((e=>{if("types"==!e.parentNode.tagName)throw new Error("Type must be inside of types tag");e.querySelectorAll("subtype");let t=[];function r(){a.forEach((e=>{if(e.var)if(t.includes(e.var)){let t=window[e.var];if(!t)throw new Error(`Variable "${e.var}" is not defined`);let r=t.trim();if("array"===e.type.toLowerCase()){if(!Array.isArray(t))throw new Error(`Variable "${e.var}" is not an array`)}else if("url"===e.type.toLowerCase()&&!r.includes("http")&&!r.includes("https"))throw new Error(`Variable "${e.var}" is not a url`);if("string"===e.type.toLowerCase()){if(!isNaN(parseFloat(r)))throw new Error(`Variable "${e.var}" is a number, not a string`);if("true"===r.toLowerCase()||"false"===r.toLowerCase())throw new Error(`Variable "${e.var}" is a boolean, not a string`)}else if("number"===e.type.toLowerCase()){if(isNaN(parseFloat(r)))throw new Error(`Variable "${e.var}" is a string, not a number`)}else{if("boolean"!==e.type.toLowerCase())throw new Error(`Unsupported type: ${e.type}`);if("true"!==r.toLowerCase()&&"false"!==r.toLowerCase())throw new Error(`Variable "${e.var}" is a string, not a boolean`)}}else t.push(e.var),window[e.var]=e.default,r();else{if(!e.prop)throw new Error("Type must have var or prop attribute");if(!n.querySelector(`[${e.prop}]`)&&!document.querySelector(`[${e.prop}]`))throw new Error(`Prop "${e.prop}" is not defined or is defined more than once`);{let t=n.querySelector(`[${e.prop}]`)?.getAttribute(e.prop)||document.querySelector(`[${e.prop}]`)?.getAttribute(e.prop);if("string"===e.type.toLowerCase()){if(!isNaN(parseFloat(t))&&!isFinite(t))throw new Error(`Prop "${e.prop}" is a number, not a string`);if("true"===t.toLowerCase()||"false"===t.toLowerCase())throw new Error(`Prop "${e.prop}" is a boolean, not a string`);if(!isNaN(parseFloat(t))&&isFinite(t))throw new Error(`Prop "${e.prop}" is a number, not a string`)}else if("boolean"===e.type.toLowerCase()){if(!isNaN(parseFloat(t)))throw new Error(`Prop "${e.prop}" is a number, not a boolean`);if("true"!==t.toLowerCase()&&"false"!==t.toLowerCase())throw new Error(`Prop "${e.prop}" is a string, not a boolean`)}}}}))}a.push({var:e.getAttribute("var")?e.getAttribute("var"):null,prop:e.getAttribute("prop")?e.getAttribute("prop"):null,type:e.getAttribute("type")?e.getAttribute("type"):null,default:e.getAttribute("default")?e.getAttribute("default"):null}),r(),window.checkType=r}))};t.map((async e=>{if(!(e.endsWith(".html")||e.endsWith(".css")||e.endsWith(".js")))throw new Error("Unsupported imported file type!");if(e.endsWith(".js")){let t=document.createElement("link");t.setAttribute("rel","preload"),t.setAttribute("href",e),t.type="text/javascript",t.setAttribute("as","script"),document.querySelector("head").appendChild(t),i[e]?i[e]:await fetch(e).then((e=>e.text())).then((t=>{if(t.includes("document")&&!e.includes("tailwind.js"))throw new Error("Imported JS file cannot contain document. Use dox instead.");if((t.includes("innerHTML")||t.includes("innerText"))&&!e.endsWith("tailwind.js"))throw new Error("Use dox:text to return text and dox:$ to return HTML.");let r=document.createElement("script");r.id="dox-script",r.type="module",r.innerHTML=t,document.head.appendChild(r)}))}if(e.endsWith(".html")){let t=document.createElement("link");t.setAttribute("rel","preload"),t.setAttribute("href",e),t.type="text/html",t.setAttribute("as","document"),document.querySelector("head").appendChild(t),i[e]?u(i[e]):await fetch(e).then((e=>e.text())).then((async t=>{i[e]=t,await u(t)}))}})),window.Router=class{constructor(e){this.routes=e||{},this.currentRoute="",window.addEventListener("hashchange",(()=>{this.route()})),window.addEventListener("DOMContentLoaded",(()=>{this.route()})),this.fallbackRoute="",this.errorOn=!1}route(){const e=window.location.hash.slice(1);this.currentRoute=e,this.navigate()}render(e){r.forEach((async t=>{let r=t.parent,n=t.template,o=t.element;if(r.getAttribute("route")==e){async function i(e){return new Promise((t=>{if(document.querySelector(e))return t(document.querySelector(e));const r=new MutationObserver((n=>{document.querySelector(e)&&(t(document.querySelector(e)),r.disconnect())}));r.observe(document.body,{childList:!0,subtree:!0})}))}o.innerHTML="",window.currentRender=o,await i(o.tagName),t.imports.length>0?t.imports.forEach((async e=>{let t,i=e.getAttribute("src"),a=e.getAttribute("exports").split(",");window[i]||(t=await fetch(i).then((e=>e.text())),window[i]=t);let s=new DOMParser,l=s.parseFromString(window[i],"text/html");await setData(l);let c=l.querySelector("body"),u=s.parseFromString(n,"text/html").querySelector("body");a.forEach((e=>{if(c.querySelector(e)){let t=c.querySelector(e).innerHTML;l.querySelector(e).innerHTML=t,u.querySelector(e).innerHTML=t,n=u.innerHTML}})),document.title=r.getAttribute("title"),await setTimeout((()=>{window.checkType(),o.innerHTML=n}),5)})):(document.title=r.getAttribute("title"),await setTimeout((()=>{window.checkType(),o.innerHTML=n}),5))}else o.innerHTML=""}))}navigate(){let t=!1;this.routes&&Object.keys(this.routes).forEach((async r=>{const{isMatch:n,params:o,query:i,asterisk:a}=this.isRouteMatch(this.currentRoute,r);if(n){t=!0;let n=r,s={...i};if(Object.keys(i).length>0&&window.location.hash.includes("?")&&o)n=r.split("?")[0],r=r.split(":")[0],this.render(r);else if(Object.keys(i).length>0&&window.location.hash.includes("?")&&a)n=r.split("?")[0],r=r.split("/*")[0],this.render(r);else if(Object.keys(o).length>0&&!window.location.hash.includes("?"))r=r.split(":")[0],this.render(r);else if(Object.keys(o).length>0&&window.location.hash.includes("?")){const e=r.split(":")[0];this.render(e)}else if(Object.keys(i).length>0&&a){const e=r.split("?")[0];this.render(e)}else if(a){const e=r.split("/*")[0]?r.split("/*")[0]:r.split("*")[0];this.render(e)}else this.render(r);setTimeout((async()=>{const t=this.routes[n];t&&(await t({params:o,query:s,asterisk:a}),window.dox=e)}),2)}else this.render("404")})),!t&&this.fallbackRoute&&(window.location.hash="#"+this.fallbackRoute)}isRouteMatch(e,t){const r=e.split("/").filter((e=>""!==e)),n=t.split("/").filter((e=>""!==e));if(r.length!==n.length&&!t.includes("*"))return{isMatch:!1};const o={};let i={},a="";for(let e=0;e<n.length;e++){const t=r[e],s=n[e];if(s.startsWith(":")&&!window.location.hash.includes("?")){const e=t;o[s.slice(1)]=e}else if(s.startsWith(":")&&window.location.hash.includes("?")){const e=s.split(":")[1].split("?")[0],r=t.split("?")[0];o[e]=r;let n=window.location.hash.split("?")[1];i=this.extractQuery(n)}else{if(s.startsWith("*")&&window.location.hash.includes("?")){a=r.slice(e).join("/"),a=a.split("?")[0];break}if(s.startsWith("*")&&!window.location.hash.includes("?")){a=r.slice(e).join("/");break}}}return{isMatch:!0,params:o,query:i,asterisk:a}}get(e,t){this.routes[e]=t}redirect(e){window.location.hash="#"+e}extractParams(e,t){const r=e.split("/").filter((e=>""!==e)),n=t.split("/").filter((e=>""!==e)),o={};for(let e=0;e<n.length;e++){const t=n[e];if(t.startsWith(":")){const n=t.slice(1),i=r[e];o[n]=i}}return o}extractQuery(e){const t=e.split("&"),r={};return t.forEach((e=>{const[t,n]=e.split("=");r[t]=decodeURIComponent(n)})),r}};const d={},p=(e,t)=>{d[e]=t,window.postMessage({name:e,value:t},"*")},h=e=>d[e];window.addEventListener("message",(e=>{if(e.origin!==window.location.origin)return;const{name:t,value:r}=e.data;d[t]=r}));const m=(e,t=(()=>{}))=>{window.addEventListener("message",(r=>{if(r.origin!==window.location.origin)return;const{name:n,value:o}=r.data;n===e&&t(o)}))};window.effect=m,window.getState=h,window.setState=p,window.dox=e;