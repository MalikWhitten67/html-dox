let imports=document.querySelector("meta[imports]").getAttribute("imports"),hooked=!1;imports=imports.split(",");let templates=[],importedElements=[],parser=new DOMParser;window.variables={},window.state={},window.props={};let fetchPromises=imports.map((function(e){let t=e.split("/").pop().split(".")[0].toLowerCase();return fetch(e).then((function(e){return e.text()})).then((function(e){return{name:t,data:e}}))})),methods={hashChangeListener:null,rootElement:null,title:e=>{if(hooked)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");document.title=e,hooked=!0},setCookie:(e,t,n)=>{if(hooked)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");let o=`${e}=${t};`;n&&(n.path&&(o+=`path=${n.path};`),n.domain&&(o+=`domain=${n.domain};`),n.maxAge&&(o+=`max-age=${n.maxAge};`),n.httpOnly&&(o+=`httpOnly=${n.httpOnly};`),n.secure&&(o+=`secure=${n.secure};`),n.sameSite&&(o+=`sameSite=${n.sameSite};`)),document.cookie=o},getCookie:e=>{const t=document.cookie.split(";");for(let n=0;n<t.length;n++){const o=t[n].trim(),r=o.split("=")[0];if(r===e){const e=o.split("=")[1];o.split(";").slice(1).map((e=>{const[t,n]=e.split("=").map((e=>e.trim()));return{[t]:n}})).reduce(((e,t)=>Object.assign(e,t)),{});return{name:r,value:e}}}return null},saveState:()=>{if(hooked)throw new Error("State has already been saved cannot save again");const e=window.location.hash.substring(1);window.sessionStorage.getItem(e)?window.location.hash=window.sessionStorage.getItem(e):window.sessionStorage.setItem(e,e),hooked=!0},restoreState:()=>{if(hooked)throw new Error("State has already been restored cannot restore again");let e=window.location.hash.substring(1);window.sessionStorage.getItem(e)?window.location.hash=window.sessionStorage.getItem(e):window.location.hash=this.currentUrl,hooked=!0},send:e=>{if(hooked)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");document.getElementById(methods.rootElement).innerHTML=e,hooked=!0},render:e=>{if(hooked)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");document.getElementById(methods.rootElement).innerHTML=window[e],window.postMessage({render:e},"*"),hooked=!0},return:()=>{hooked&&(hooked=!1),methods.hashChangeListener&&(window.removeEventListener("hashchange",methods.hashChangeListener),methods.hashChangeListener=null,console.log("removed last event listener"))},sendStatus:(e,t)=>{if(hooked)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");if("number"!=typeof t)throw new Error("Invalid status code");document.getElementById(this.rootElement).innerHTML=JSON.stringify({msg:e,code:t}),hooked=!0},redirect:e=>{if(hooked)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");window.location.hash=e,hooked=!0},sendFile:e=>{let t=this.rootElement;if(hooked)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");let n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){if(e.endsWith(".png"))document.getElementById(t).style="\n          position: fixed;\n         top: 0;\n        left: 0;\n       width: 100%;\n     height: 100%;\n    background-color: black;\n          \n          ",document.getElementById(t).innerHTML=` \n  <img src="${e}" style="resize: none; border: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);"/>`;else if(e.endsWith(".json"))fetch(e).then((e=>e.json())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${JSON.stringify(e)}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".js"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".css"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".html"))fetch(e).then((e=>e.text())).then((e=>{const n=`<textarea style="width:100%;height:100%; resize:none; border:none;">${e}</textarea>`;document.getElementById(t).innerHTML=n}));else if(e.endsWith(".img")||e.endsWith(".png")||e.endsWith(".jpg")||e.endsWith(".jpeg")||e.endsWith(".gif")||e.endsWith(".svg")||e.endsWith(".ico"))document.getElementById(t).innerHTML=`\n              <img src="${e}" \n              \n              style="width:100%;height:100%; resize:none; border:none; position:absolute; top:0; left:0;"\n               \n              />\n              `;else if(e.endsWith(".pdf"))document.getElementById(t).innerHTML=`\n              <embed src="${e}" \n              \n              style="width:100%;height:100%; resize:none; border:none; position:absolute; top:0; left:0;"\n               \n              />\n              `;else if(e.endsWith(".mp4")||e.endsWith(".webm")||e.endsWith(".ogg")){let n=document.createElement("video");n.src=e,n.controls=!0,document.getElementById(t).appendChild(n)}else{let n=document.createElement("audio");n.src=e,n.controls=!0,document.getElementById(t).appendChild(n)}let o=document.createElement("a");o.href=window.URL.createObjectURL(n.response),o.download=e,o.click()},n.send()}};class Router{constructor(){this.routes={},this.currentUrl="",this.store={},this.rootElement=null,this.hashChangeListener=null,this.listeners={},this.storedroutes=[],this.errorcheck=null,this.headers={},this.customerror=null,this.hooked=!1}get(e,t){const n=[],o=[],r=e.split("/").map((e=>e.startsWith(":")?(n.push(e.substring(1)),"([^/]+)"):e.startsWith("*")?(n.push(e.substring(1)),"(.*)"):e.startsWith("?")?(o.push(e.substring(1)),"([^/]+)"):e)).join("/"),s=new RegExp("^"+r+"(\\?(.*))?$");if(window.location.hash.substring(1).match(s)){this.storedroutes.push(window.location.hash.substring(1)),this.hooked=!0,this.routes[e]=!0;const o=window.location.hash.substring(1).match(s),r={};for(let e=0;e<n.length;e++)r[n[e]]=o[e+1];if(e.includes(":")&&window.location.hash.substring(1).split("?")[1])return debug.enabled&&debug.log([`\n                Cannot use query params with path params ${e} ${window.location.hash.substring(1).split("?")[1]}`],"assert"),!1;const i={},a=window.location.hash.substring(1).split("?")[1];if(a){const e=a.split("&");for(let t=0;t<e.length;t++){const n=e[t].split("=");i[n[0]]=n[1]}}const l={params:r,query:i,url:window.location.hash.substring(1),method:"GET"};window.$URL_PARAMS=r,window.$URL_QUERY=i,methods.rootElement=this.rootElement,methods.hashChangeListener=this.hashChangeListener;return t(l,methods),!0}return this.hooked=!1,!1}error(e){this.errorcheck=!0;window.onhashchange=()=>{if(!this.storedroutes.includes(window.location.hash.substring(1))){const t=methods;null===this.customerror?document.getElementById(this.rootElement).innerHTML=`<code>Cannot GET ${window.location.hash.substring(1)}</code>`:e(t)}};const t=methods;this.storedroutes.includes(window.location.hash.substring(1))||(this.customerror?e(t):document.getElementById(this.rootElement).innerHTML=`<code>Cannot GET ${window.location.hash.substring(1)}</code>`)}root(e,t){const n=[],o=[],r=window.location.hash.substring(1);this.hooked||this.storedroutes.includes(r)||(this.storedroutes.push(r),window.location.hash=r);const s=e.split("/").map((e=>e.startsWith(":")?(n.push(e.substring(1)),"([^/]+)"):e.startsWith("*")?(n.push(e.substring(1)),"(.*)"):e.startsWith("?")?(o.push(e.substring(1)),"([^/]+)"):e)).join("/"),i=new RegExp("^"+s+"(\\?(.*))?$");if(""===r)if(0===n.length)window.location.hash=e;else{const t=e.split("/").map((e=>e.startsWith(":")?"":e)).join("/");window.location.hash=t}else{const t=r.match(i);if(t){const o={};n.forEach(((e,n)=>{o[e]=t[n+1]}));const r=e.split("/").map((e=>e.startsWith(":")?o[e.substring(1)]:e)).join("/");window.location.hash=r}}if(this.routes[e]=!0,this.currentUrl=e,window.$CURRENT_URL=e,window.location.hash.substring(1).match(i)){const o=window.location.hash.substring(1).match(i),r={};for(let e=0;e<n.length;e++)r[n[e]]=o[e+1];if(e.includes(":")&&window.location.hash.substring(1).split("?")[1])return console.error(`\n               [DoxDom: Cannot use query params with path params ${e} ${window.location.hash.substring(1).split("?")[1]}\n              `),!1;const s={},a=window.location.hash.substring(1).split("?")[1];if(a){const e=a.split("&");for(let t=0;t<e.length;t++){const n=e[t].split("=");s[n[0]]=n[1]}}const l={params:r,query:s,url:window.location.hash.substring(1),method:"ROOT_GET"};window.$URL_PARAMS=r,window.$URL_QUERY=s,methods.rootElement=this.rootElement,methods.hashChangeListener=this.hashChangeListener;const d=methods;return this.hashChangeListener||(this.hashChangeListener=()=>{if(window.location.hash.substring(1).match(i)){const e=window.location.hash.substring(1).match(i),o={};for(let t=0;t<n.length;t++)o[n[t]]=e[t+1];const r={params:o,rootUrl:this.currentUrl,url:window.location.hash.substring(1)};window.$CURRENT_URL=window.location.hash.substring(1);t(r,methods)}},window.addEventListener("hashchange",this.hashChangeListener)),t(l,d),!0}return!1}post(e,t){let n=!1;this.sendContent=null;t({set:(e,t)=>{let n=["Accept","Accept-Charset","Accept-Encoding","Accept-Language","Accept-Datetime","Access-Control-Request-Method","Access-Control-Request-Headers","Authorization","Cache-Control","Connection","Cookie","Content-Length","Content-MD5","Content-Type","Date"];if(!n.includes(e))throw new Error({message:"Invalid header name",name:e,accepted_headers:n});if("string"!=typeof t)throw new Error("Invalid header value");this.headers[e]=t},json:e=>{if("application/json"!=this.headers["Content-Type"])throw new Error("Content-Type header must be set to application/json");if(n)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");try{const t=JSON.stringify(e);this.sendContent=t,n=!0}catch(e){throw new Error("Invalid JSON data")}},jsonp:e=>{if("application/json"!=this.headers["Content-Type"])throw new Error("Content-Type header must be set to application/json");if(n)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");try{const t=JSON.stringify(e);this.sendContent=`callback(${t})`,n=!0}catch(e){throw new Error("Invalid JSON data")}},text:e=>{if("text/plain"==this.headers["Content-Type"]){if(n)throw new Error("Cannot send headers after they where already sent please refrain from using double res functions and call res.return() to resend to client");try{const t=e;this.sendContent=t,n=!0}catch(e){throw new Error("Invalid text data")}}},return:()=>{n&&(n=!1),this.hashChangeListener&&(window.removeEventListener("hashchange",this.hashChangeListener),this.hashChangeListener=null,console.log("removed last event listener"))}});const o={path:e,data:this.sendContent,headers:this.headers};window.postMessage(o,"*")}listen(e,t){if(this.listeners[e])throw new Error(`Listener already registered for route ${e}`);const n=n=>{const o=n.data.path,r=n.data.data,s=n.data.headers;o===e&&t({data:r,headers:s,method:"POST"})};window.addEventListener("message",n),this.listeners[e]=n}stopListening(e){const t=this.listeners[e];t&&(window.removeEventListener("message",t),delete this.listeners[e])}use(e){const t=[],n=[],o=e.split("/").map((e=>e.startsWith(":")?(t.push(e.substring(1)),"([^/]+)"):e.startsWith("*")?(t.push(e.substring(1)),"(.*)"):e.startsWith("?")?(n.push(e.substring(1)),"([^/]+)"):e)).join("/");new RegExp("^"+o+"(\\?(.*))?$");e=o,this.routes[e]=!0,this.storedroutes.push(e)}bindRoot(e){this.rootElement=e}onload(e){window.onload=()=>{window.addEventListener("DOMContentLoaded",e())}}on(e,t){window.addEventListener("hashchange",(()=>{const n=[],o=[],r=e.split("/").map((e=>e.startsWith(":")?(n.push(e.substring(1)),"([^/]+)"):e.startsWith("*")?(n.push(e.substring(1)),"(.*)"):e.startsWith("?")?(o.push(e.substring(1)),"([^/]+)"):e)).join("/"),s=new RegExp("^"+r+"(\\?(.*))?$");if(this.routes[e]=!0,this.currentUrl=e,window.$CURRENT_URL=e,window.location.hash.substring(1).match(s)){this.storedroutes.push(window.location.hash.substring(1)),this.routes[e]=!0;const o=window.location.hash.substring(1).match(s),r={};for(let e=0;e<n.length;e++)r[n[e]]=o[e+1];if(e.includes(":")&&window.location.hash.substring(1).split("?")[1])return console.error("Cannot use query params with path params",e,window.location.hash.substring(1).split("?")[1]),!1;const i={},a=window.location.hash.substring(1).split("?")[1];if(a){const e=a.split("&");for(let t=0;t<e.length;t++){const n=e[t].split("=");i[n[0]]=n[1]}}const l={params:r,query:i,url:window.location.hash.substring(1),method:"POST"};window.$URL_QUERY=i,window.$URL_PARAMS=r,methods.rootElement=this.rootElement,methods.hashChangeListener=this.hashChangeListener;t(l,methods)}}))}}function handleVariables(e){return Object.keys(window.variables).forEach((function(t){if(Array.isArray(window.variables[t])){return window.variables[t].forEach((function(n){Object.keys(n).forEach((function(o){let r=n[o],s=new RegExp("{{"+t+"."+o+"}}","g");e.body.innerHTML=e.body.innerHTML.replaceAll(s,r)}))})),e}let n=new RegExp("{{"+t+"}}","g");e.body.innerHTML=e.body.innerHTML.replaceAll(n,window.variables[t])})),e}function handleProps(e){return Object.keys(window.props).forEach((function(t){if(Array.isArray(window.props[t])){return window.props[t].forEach((function(n){Object.keys(n).forEach((function(o){let r=n[o],s=new RegExp("{{"+t+"."+o+"}}","g");e.body.innerHTML=e.body.innerHTML.replaceAll(s,r)}))})),e}let n=new RegExp("{{"+t+"}}","g");e.body.querySelectorAll("*").forEach((function(e){e.getAttribute(t)&&(window[t]=e.getAttribute(t),e.outerHTML=e.outerHTML.replaceAll(n,window[t]))})),null===window.props[t]&&""===window.props[t]||(e.body.innerHTML=e.body.innerHTML.replaceAll(n,window.props[t]))})),e}function doxMethods(e){return e.on=function(t,n){e&&e.addEventListener(t,n);let o=setInterval((function(){document.querySelector(e.tagName)&&(document.querySelector(e.tagName).addEventListener(t,n),clearInterval(o))}),1e3);return e},e.toggleClass=function(t){return e.classList.contains(t)?e.classList.remove(t):e.classList.add(t),e},e.css=function(t){return t?(e.style.cssText=t,e):e.style.cssText},e.attr=function(t,n){return n?(e.setAttribute(t,n),e):e.getAttribute(t)},e.val=function(t){return t?(e.value=t,e):e.value},e.classes=function(t){return t?(e.className=t,e):e.className},e.animate=function(t,n){return t&&n?(e.animate(t,n),e):e.animate},e.pre=function(e){return e.prepend(e),e},e.html=function(t){return t?(e.innerHTML=t,e):e.innerHTML},e.add=function(t,n){let o=document.createElement(t);return Object.keys(n).forEach((function(e){o.setAttribute(e,n[e])})),e.appendChild(o),doxMethods(o)},e.remove=function(){e.parentNode.removeChild(e)},e.parent=function(){return doxMethods(e.parentNode)},e.search=function(t){let n=new RegExp(t,"g");return e.innerHTML.match(n)},e}function setVar(e,t){window.variables[e]=t}function getState(e){return window.state[e]}function setState(e,t){window.postMessage({type:"state",name:e,value:t},"*"),window.state[e]=t}function effect(e,t){window.addEventListener("message",(function(n){"state"==n.data.type&&n.data.name==e&&t(n.data.value)}))}function setDox(html){let dox={querySelector:function(e){return doxMethods(document.querySelector(e)||html.body.querySelector(e))},awaitElement:async function(e){let t=document.querySelector(e);return t?doxMethods(t):new Promise(((n,o)=>{let r=!1;const s=new MutationObserver((o=>{r||(t=document.querySelector(e),t&&(r=!0,s.disconnect(),n(doxMethods(t))))}));s.observe(document.documentElement,{childList:!0,subtree:!0})}))},getId:function(e){return doxMethods(html.body.querySelector("#"+e)||document.querySelector("#"+e))},driver:function(e,t){this[e]=t},add:function(e,t={}){let n=document.createElement(e);return Object.keys(t).forEach((function(e){n.setAttribute(e,t[e])})),doxMethods(n)},validate:function(type,value,options){if("email"===type){let required=options.required,regex=options.regex,time=options.await&&options.await.time?options.await.time:null,tdo=options.await&&options.await.fn?options.await.fn:null;function setStyles(){document.querySelector('input[type="email"]').style.cssText=options.style}function clearStyles(){document.querySelector('input[type="email"]').style.cssText=""}if(required&&!value&&(setStyles(),time&&tdo&&setTimeout((function(){eval(tdo)}),time),alert(options.message.required)),value&&regex&&!regex.test(value))setStyles(),time&&tdo&&setTimeout((function(){eval(tdo)}),time),alert(options.message.invalid),setStyles();else if(!regex){let emailRegex=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;emailRegex.test(value)||(setStyles(),time&&tdo&&setTimeout((function(){eval(tdo)}),time),alert(options.message.invalid))}}else{if("password"!==type)throw new Error("Unsupported validation type: "+type);{let required=options.required,minLength=options.min,maxLength=options.max,time=options.await&&options.await.time?options.await.time:null,tdo=options.await&&options.await.fn?options.await.fn:null;function setStyles(){document.querySelector('input[type="password"]').style.cssText=options.style}function clearStyles(){document.querySelector('input[type="password"]').style.cssText=""}window.setStyles=setStyles,window.clearStyles=clearStyles,required&&!value&&(time&&tdo&&setTimeout((function(){eval(tdo)}),time),setStyles(),alert(options.message.required)),minLength&&value.length<minLength&&(time&&tdo&&setTimeout((function(){eval(tdo)}),time),setStyles(),alert(options.message.tooShort)),maxLength&&value.length>maxLength&&(time&&tdo&&setTimeout((function(){eval(tdo)}),time),setStyles(),alert(options.message.tooLong))}}},setVar:setVar};window.dox=dox,window.setState=setState,window.getState=getState,window.effect=effect}function handleLogic(html){let content=html.body.innerHTML;const ifRegex=/#if\s*\(([\s\S]*?)\)\s*;([\s\S]*?)(?:#else([\s\S]*?))?#endif/;let match=content.match(ifRegex);for(;match;){const[fullMatch,condition,ifStatement,elseStatement]=match;let processedStatement;processedStatement=eval(condition.trim())?ifStatement.includes("return")?ifStatement:`<script>${ifStatement}<\/script>`:elseStatement&&!elseStatement.includes("#if")?elseStatement.includes("return")?elseStatement:`<script>${elseStatement}<\/script>`:"",content=content.replace(fullMatch,processedStatement),match=content.match(ifRegex)}return content=content.replaceAll("return",""),html.body.innerHTML=content,html}function executeStatement(e){if(e.includes("return")){const t=e.indexOf("return"),n=e.slice(t+6).trim();if(!n.startsWith("function"))return n;try{return new Function(n)()||""}catch(e){return console.error("Error executing function:",e),""}}return e}function handleMarkdown(e){return e.body.querySelectorAll("markdown").forEach((function(t){t.style.display="flex",t.style.flexDirection="column";let n=t.innerHTML;n=n.replace("&gt;",">");n=n.replace(/`([^`]+)`/g,"<code>$1</code>"),n=n.replace(/\[(.*?)\]\((.*?)\)/g,'<a  style="color: #007bff; text-decoration:none" href="$2">$1</a>'),n=n.replace(/> (.+)(\n|$)/g,'<blockquote style="border-left: 5px solid #eeeeee; padding-left: 10px;">$1</blockquote>'),n=n.replace(/^---$/gm,"<hr>"),n=n.replace(/\*\*([\s\S]*?)\*\*/g,"<strong>$1</strong>"),n=n.replace(/#{1,6}\s+(.*)/g,(function(e,t){let n=e.split(" ")[0].length;if(n>6)throw new Error("Heading level cannot be greater than 6");return"<h"+n+">"+t+"</h"+n+">"})),n=n.replace(/\|(.+)\|/g,(function(e,t){let n=t.split("\n"),o='<table class="table table-striped table-bordered">';return n.forEach((function(e){let t=e.split("|"),n="<tr>";t.forEach((function(e){n+="<td>"+e+"</td>"})),n+="</tr>",o+=n})),o+="</table>",o})),n=n.replace(/\*([\s\S]*?)\*/g,"<em>$1</em>"),n=n.replace(/- (.+)(\n|$)/g,"<li>$1</li>"),n=n.replace(/\d+\. (.+)(\n|$)/g,"<li>$1</li>"),e.body.innerHTML=e.body.innerHTML.replace(t.innerHTML,n)})),e}function handleScripts(html){if(html){for(var scripts=html.body.querySelectorAll("script"),variableRegex=/let\s+(\w+)\s*=\s*([\s\S]*?)(?:;|$)/g,importRegex=/import\s+{(.*?)}\s+from\s+['"](.*?)['"]/g,beforeRenderScripts=[],i=0;i<scripts.length;i++){var script=scripts[i];if(script.hasAttribute("execute")||script.hasAttribute("props")){if("beforeRender"===script.getAttribute("execute")){var s=script.innerHTML;beforeRenderScripts.push(s)}else if(script.hasAttribute("props"))for(var s=script.innerHTML,match;null!==(match=variableRegex.exec(s));){var name=match[1].trim(),value=match[2].trim();value.includes("{")&&(value=value.replace("{","").replace("}","").trim(),value=value.split(",").map((function(e){var t=e.split(":")[0].trim(),n=e.split(":")[1].trim(),o={};return o[t]=n,o})));var elementsWithProp=html.querySelectorAll(`[${name}]`);elementsWithProp.forEach((function(e){var t=e.getAttribute(name);e.innerHTML=e.innerHTML.replaceAll("{{"+name+"}}",t),e.removeAttribute(name)})),value=eval(value),window.props[name]=value,window[name]=value}}else for(var s=script.innerHTML,match;null!==(match=variableRegex.exec(s));){var name=match[1].trim(),value=match[2].trim();value.includes("{")&&(value=value.replace("{","").replace("}","").trim(),value=value.split(",").map((function(e){var t=e.split(":")[0].trim(),n=e.split(":")[1].trim(),o={};return o[t]=n,o}))),window.variables[name]=eval(value),window[name]=eval(value)}}if(html.body.outerHTML.includes("${{")){let matches=html.body.outerHTML.match(/\${{([\s\S]*?)}}/g);matches&&matches.forEach((function(match){let js=match.replace("${{","").replace("}}",""),value=eval(js);html.body.outerHTML=html.body.outerHTML.replaceAll(match,value)}))}return{html:html,beforeRenderScripts:beforeRenderScripts}}}function handleImports(e){let t=e.querySelectorAll("import"),n=[];for(var o=0;o<t.length;o++){let r=t[o].getAttribute("src"),s=r.split("/").pop().split(".")[0].toLowerCase(),i=fetch(r).then((function(e){return e.text()})).then((function(t){return handleImports(parser.parseFromString(t,"text/html")).then((function(t){let{html:n,beforeRenderScripts:o}=handleScripts(t);n=handleLogic(n),n=handleMarkdown(n),o.forEach((function(e){e.includes("dox")&&setDox(n);let t=document.createElement("script"),o=s+"-script";document.getElementById(o)||(t.innerHTML=e,t.type="module",t.id=o,document.getElementById(o)||document.head.appendChild(t))}));let r=n.body.outerHTML.match(/```([\s\S]*?)```/g);r&&r.forEach((function(e){n.body.outerHTML=n.body.outerHTML.replaceAll(e,"\x3c!-- "+e+" --\x3e")})),e.querySelector(s)&&e.querySelectorAll(s).forEach((function(e){let t=document.createElement(e.tagName),o=e.attributes;for(let e=0;e<o.length;e++)t.setAttribute(o[e].name,o[e].value);t.innerHTML=n.body.innerHTML,e.replaceWith(t)})),importedElements.push({name:s,element:n})}))}));n.push(i)}return Promise.all(n).then((function(){return e}))}function processElement(e){(e=e.element).parentElement;let t=e.tagName.toLowerCase();importedElements.forEach((function(n){if(n.name===t){let o=handleScripts(n.element).html;if(o=handleVariables(o),o=handleMarkdown(o),o=o.body.querySelector(t),!o||""===o.innerHTML.trim())return;let r=document.createElement(t);for(let t=0;t<e.attributes.length;t++){let{name:n,value:o}=e.attributes[t];r.setAttribute(n,o)}r.innerHTML=o.innerHTML,r.setAttribute("data-dynamic_element","true"),r.innerHTML.includes("dox")&&setDox(r),document.querySelectorAll(t).forEach((function(e){let n=document.createElement(t);for(let t=0;t<e.attributes.length;t++){let{name:o,value:r}=e.attributes[t];n.setAttribute(o,r)}n.innerHTML=r.innerHTML,e.replaceWith(n)}))}}))}function observeNewElements(){if(observeNewElements.observerActive)return;observeNewElements.observerActive=!0;let e=new MutationObserver((function(t){let n=!1;t.forEach((function(e){if(!n){if(n=!0,"childList"===e.type){e.addedNodes.forEach((function(e){if(e.tagName){let t=e.tagName.toLowerCase(),n=document.querySelector(t)||document.body.querySelectorAll(t),o=e.parentNode;n&&!window[t]&&"import"!==t&&(o=n.parentNode,processElement({element:n,parent:o}),document.body.innerHTML=handleProps(document).body.innerHTML)}}))}n=!1}})),observeNewElements.observerActive=!1,e.disconnect(),observeNewElements()}));e.observe(document.body,{childList:!0,subtree:!0})}window.Router=Router,window.$CURRENT_URL=window.location.hash.substring(1),setDox(document),Promise.all(fetchPromises).then((function(fetchedTemplates){return templates=fetchedTemplates,Promise.all(templates.map((function(template){let d=parser.parseFromString(template.data,"text/html"),matches=d.body.outerHTML.match(/```([\s\S]*?)```/g);matches&&matches.forEach((function(e){d.body.outerHTML=d.body.outerHTML.replaceAll(e,"\x3c!-- "+e+" --\x3e")}));let{beforeRenderScripts:beforeRenderScripts}=handleScripts(d),fetchPromises=[];return beforeRenderScripts.forEach((function(script){if(script.includes("fetch")){setDox(d);let fetchPromise=eval(script);fetchPromises.push(fetchPromise)}else if(script.includes("dox")){setDox(d);let e=document.createElement("script"),t=template.name+"-script";document.getElementById(t)||(e.innerHTML=script,e.type="module",cons,e.id=t,document.head.appendChild(e))}else{let e=document.createElement("script"),t=template.name+"-script";document.getElementById(t)||(e.innerHTML=script,e.type="module",e.id=t,document.head.appendChild(e))}})),Promise.all(fetchPromises).then((function(){return handleImports(d)})).then((function(e){let{html:t,beforeRenderScripts:n}=handleScripts(e);return n.forEach((function(e){if(e.includes("dox")){setDox(t);let n=document.createElement("script"),o=template.name+"-script";document.getElementById(o)||(n.innerHTML=e,n.id=o,n.type="module",document.head.appendChild(n))}else{let t=document.createElement("script"),n=template.name+"-script";document.getElementById(n)||(t.innerHTML=e,t.type="module",t.id=n,document.head.appendChild(t))}})),Object.keys(window.props).forEach((function(e){let n=new RegExp("{{"+e+"}}","g");t.body.innerHTML=t.body.innerHTML.replaceAll(n,window.props[e])})),t=handleLogic(t),t=handleMarkdown(t),t=handleVariables(t),template.data=t.body.innerHTML,{template:template}}))})))})).then((function(e){e.forEach((function(e){window[e.template.name]=e.template.data,window.dox=dox}))})).then((function(){imports.forEach((function(e){e.endsWith(".js")&&fetch(e).then((e=>e.text())).then((t=>{let n=document.createElement("script"),o=e.split("/").pop().split(".")[0].toLowerCase()+"-script";n.id=o,n.innerHTML=t,n.type="module",document.getElementById(o)||document.head.appendChild(n)}))})),observeNewElements()})).catch((function(e){console.error("Error fetching templates:",e)}));