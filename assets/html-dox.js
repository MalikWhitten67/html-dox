let e=[],t=document.querySelector("imports");t.style.display="none";let r=t.innerHTML.replace(/\s/g,"");if(r=r.split(","),r=r.filter(Boolean),document.querySelector("script")&&!document.querySelector("script").getAttribute("src").includes("html-dox.js"))throw new Error("html-dox.js must be the last script tag in the body");if(document.querySelector("style"))throw new Error("Style tags are not supported in dox!");if(document.querySelector("link"))throw new Error("Link tags are not supported in dox!");document.body.style.display="none";let n=[],o={"dox:string":String,"dox:number":Number,"dox:boolean":Boolean,"dox:array":Array,"dox:object":Object,"dox:undefined":void 0,"dox:null":null,"dox:function":Function,"dox:regexp":RegExp,"dox:date":Date};r.forEach((e=>{if(!e.endsWith(".html")&&!e.endsWith(".css")&&!e.endsWith(".js"))throw new Error("Unsupported imported file type!");if(e.endsWith(".html"))fetch(e).then((e=>e.text())).then((e=>{i(e)}));else if(e.endsWith(".css")){let t=document.createElement("link");t.setAttribute("rel","preload"),t.setAttribute("href",e),t.type="text/css",t.setAttribute("as","style");let r=document.createElement("link");r.setAttribute("rel","stylesheet"),r.setAttribute("href",e),r.type="text/css",document.querySelector("head").appendChild(r),document.querySelector("head").appendChild(t)}else e.endsWith(".js")&&fetch(e).then((e=>e.text())).then((t=>{if(t.includes("import "))throw new Error('Import statements with the "from" keyword are not allowed. Use $import instead.');if(t.includes("export "))throw new Error("Export statements are not allowed. Use $export instead.");if(t.includes("document")&&!e.includes("tailwind.js"))throw new Error("Imported JS file cannot contain document. Use dox instead.");if((t.includes("innerHTML")||t.includes("innerText"))&&!e.endsWith("tailwind.js"))throw new Error("Use dox:text to return text and dox:$ to return HTML.");new Function(t)()}))}));const i=t=>{let r=(new DOMParser).parseFromString(t,"text/html");r=r.querySelector("html");let i=document.querySelector("body"),l=[],s=r.querySelector("export");s.style.display="none";let a={querySelector:e=>{let t=document.querySelector(e)||r.querySelector(e);if(t){let e={getDescendants:()=>{let e=[],r=t=>{let n=t.children;for(let t=0;t<n.length;t++)e.push(n[t]),r(n[t])};return r(t),{forEach:r=>{e.forEach((n=>{r({id:n.id,class:n.className,text:n.innerText,html:n.innerHTML,getChildren:()=>{let e=[];return n.querySelectorAll("*").forEach((r=>{r.parentNode===t&&e.push(r)})),e},getAncestors:()=>{let e=[],t=n.parentNode;for(;t;)e.push(t),t=t.parentNode;return e},querySelector:t=>(e=e.filter((e=>e.matches(t))),e),fadeIn:e=>{n.style.opacity=0,n.style.transition=`opacity ${e}s`,n.style.opacity=1},fadeOut:e=>{n.style.opacity=1,n.style.transition=`opacity ${e}s`,n.style.opacity=0},on:(e,t)=>{n.addEventListener(e,t)},inject:e=>{n.innerHTML=e},state:e=>{let t=l.find((t=>t.name===e));if(t)return t.value;throw new Error(`State "${e}" does not exist`)},setState:(e,t)=>{let r=l.find((t=>t.name===e));r?r.value=t:l.push({name:e,value:t})},watch:(e,t)=>{let r=l.find((t=>t.name===e));if(!r)throw new Error(`State "${e}" does not exist`);t(r.value)}})}))},map:t=>{let r=[];return e.forEach((e=>{r.push(t(e))})),r},querySelector:e=>{a.querySelector(e)},querySelectorAll:t=>(e=e.filter((e=>e.matches(t))),e),inject:(e,t)=>{let r=document.querySelector(e);r&&(r.innerHTML=t)},html:()=>{let t="";return e.forEach((e=>{t+=e.outerHTML})),t},getAncestors:()=>{let e=[],r=t.parentNode;for(;r;)e.push(r),r=r.parentNode;return e}}},inject:(e,t)=>{let r=document.querySelector(e);r&&(r.innerHTML=t)},getAncestors:()=>{let e=[],r=t.parentNode;for(;r;)e.push(r),r=r.parentNode;return e},text:t.innerText,html:t.innerHTML,getChildren:()=>{let e=[];return t.querySelectorAll("*").forEach((r=>{r.parentNode===t&&e.push(r)})),e}};return e}return null},querySelectorAll:e=>{let t=document.querySelectorAll(e)||r.querySelectorAll(e);if(t){let e={forEach:e=>{t.forEach((r=>{e({id:r.id,class:r.className,text:r.innerText,html:r.innerHTML,getChildren:()=>{let e=[];return r.querySelectorAll("*").forEach((t=>{t.parentNode===el&&e.push(t)})),e},getAncestors:()=>{let e=[],t=r.parentNode;for(;t;)e.push(t),t=t.parentNode;return e},querySelector:e=>(t=t.filter((t=>t.matches(e))),t),fadeIn:e=>{r.style.opacity=0,r.style.transition=`opacity ${e}s`,r.style.opacity=1},fadeOut:e=>{r.style.opacity=1,r.style.transition=`opacity ${e}s`,r.style.opacity=0},on:(e,t)=>{r.addEventListener(e,t)},inject:e=>{r.innerHTML=e},state:e=>{let t=l.find((t=>t.name===e));if(t)return t.value;throw new Error(`State "${e}" does not exist`)},setState:(e,t)=>{let r=l.find((t=>t.name===e));r?r.value=t:l.push({name:e,value:t})},watch:(e,t)=>{let r=l.find((t=>t.name===e));if(!r)throw new Error(`State "${e}" does not exist`);t(r.value)}})}))},map:e=>{let r=[];return t.forEach((t=>{r.push(e(t))})),r},querySelector:e=>{a.querySelector(e)},querySelectorAll:e=>(t=t.filter((t=>t.matches(e))),t),inject:(e,t)=>{let r=document.querySelector(e);r&&(r.innerHTML=t)},getAncestors:()=>{let e=[],t=el.parentNode;for(;t;)e.push(t),t=t.parentNode;return e},text:el.innerText,html:el.innerHTML,getChildren:()=>{let e=[];return el.querySelectorAll("*").forEach((t=>{t.parentNode===el&&e.push(t)})),e}};return e}return null}};window.$import=e=>{if(!e.endsWith(".js"))return window[e];fetch(file).then((e=>e.text())).then((e=>{if(e.includes("import "))throw new Error('Import statements with the "from" keyword are not allowed. Use $import instead.');if(e.includes("export "))throw new Error("Export statements are not allowed. Use $export instead.");if(e.includes("document")&&!item.includes("tailwind.js"))throw new Error("Imported js file cannot contain document use dox instead");if(e.includes("innerHTML")||e.includes("innerText")&&!item.endsWith("tailwind.js"))throw new Error("use dox:text  to return text and dox:$ to return html");new Function(e)()}))},window.$export=(e,t)=>{window[e]=t},window.dox=a,i.querySelectorAll("type").forEach((e=>{let t=e.querySelectorAll("subtype");n.push({name:e.getAttribute("name"),constraint:e.getAttribute("constraint"),isStrict:e.getAttribute("isStrict")}),e.querySelectorAll("subtype").forEach((e=>{if(!o[e.getAttribute("constraint")])throw new Error("The constraint type does not exist");n.push({name:e.getAttribute("name"),constraint:e.getAttribute("constraint")})})),t.forEach((e=>{if(!o[e.getAttribute("constraint")])throw new Error("The constraint type does not exist");n.push({name:e.getAttribute("name"),constraint:e.getAttribute("constraint")})})),r.querySelectorAll("[subtype]").forEach((e=>{if(e.innerHTML.includes("{{")){let t=e.innerHTML.split("{{")[1].split("}}")[0];i.querySelectorAll(`[${t}]`).forEach((r=>{let i=r.getAttribute(t),l=e.getAttribute("subtype"),s=n.find((e=>e.name===l)),a=s.isStrict;if(s&&a){let e,t=o[s.constraint];if(t===Number){if(e=Number(i),e=isNaN(e)?0:e,0===e)throw new Error(`Invalid  value for subtype "${l}": ${i} (expected number)`)}else if(t===Boolean)if("true"===i.toLowerCase())e=!0;else{if("false"!==i.toLowerCase())throw new Error(`Invalid attribute value for subtype "${l}": ${i} (expected boolean)`);e=!1}else{if(t!==String)throw new Error(`Invalid constraint type for subtype "${l}": ${s.constraint}`);e=i}}}))}}))})),r.querySelectorAll("type").forEach((e=>{let t=e.querySelectorAll("subtype"),l=[];t.forEach((t=>{if(l.push(t.getAttribute("name")),l.filter(((e,t)=>l.indexOf(e)!==t)).length>0)throw new Error("Two subtypes cannot have the same name");if(t.getAttribute("name")===e.getAttribute("name"))throw new Error("Types and subtypes cannot have the same name")})),n.push({name:e.getAttribute("name"),constraint:e.getAttribute("constraint"),isStrict:e.getAttribute("isStrict")}),e.querySelectorAll("subtype").forEach((e=>{if(!o[e.getAttribute("constraint")])throw new Error("The constraint type does not exist");n.push({name:e.getAttribute("name"),constraint:e.getAttribute("constraint"),isStrict:e.getAttribute("isStrict")})})),r.querySelectorAll("[subtype]").forEach((e=>{if(e.innerHTML.includes("{{")){let t=e.innerHTML.split("{{")[1].split("}}")[0];i.querySelectorAll(`[${t}]`).forEach((r=>{let i=r.getAttribute(t),l=e.getAttribute("subtype"),s=n.find((e=>e.name===l)),a=s.isStrict;if(s&&a){let e,t=o[s.constraint];if(t===Number){if(e=Number(i),e=isNaN(e)?0:e,0===e)throw new Error(`Invalid  value for subtype "${l}": ${i} (expected number)`)}else if(t===Boolean)if("true"===i.toLowerCase())e=!0;else{if("false"!==i.toLowerCase())throw new Error(`Invalid attribute value for subtype "${l}": ${i} (expected boolean)`);e=!1}else{if(t!==String)throw new Error(`Invalid constraint type for subtype "${l}": ${s.constraint}`);e=i}}}))}}))})),r.querySelectorAll("var").forEach((e=>{let t=e.getAttribute("name"),r=e.innerHTML;window[t]=r})),r.querySelectorAll("*").forEach((e=>{let t=e.innerHTML.match(/{{(.*?)}}/g);t&&t.forEach((t=>{let r=t.split("{{")[1].split("}}")[0];window.hasOwnProperty(r)&&(e.innerHTML=e.innerHTML.replace(`{{${r}}}`,window[r]))}))})),r.querySelectorAll("import").forEach((e=>{let t=e.getAttribute("src");if(!t.endsWith(".html"))throw new Error("Unsupported imported file type!");fetch(t).then((e=>e.text())).then((t=>{let n=e.getAttribute("exports").split(","),o=(new DOMParser).parseFromString(t,"text/html");if(o.querySelectorAll("var").forEach((e=>{let t=e.getAttribute("name"),r=e.innerHTML;window[t]=r})),o.querySelectorAll("*").forEach((e=>{let t=e.innerHTML.match(/{{(.*?)}}/g);t&&t.forEach((t=>{let r=t.split("{{")[1].split("}}")[0];window.hasOwnProperty(r)&&(e.innerHTML=e.innerHTML.replace(`{{${r}}}`,window[r]))}))})),o.querySelector("export")){o.querySelector("export").innerHTML.split(",").forEach((e=>{let t=e.replace(/\s/g,"");n.forEach((e=>{if(e==t&&r.querySelector(t)){if(r.querySelector(t).innerHTML.includes("{{")){let e=r.querySelector(t).innerHTML.split("{{")[1].split("}}")[0];r.querySelector(t).innerHTML=window[e]}i.querySelector(t).innerHTML=o.querySelector(t).innerHTML}}))}))}}))})),s&&(s=s.innerHTML.replace(/\s/g,""),s=s.split(","),s=s.filter(Boolean),s.forEach((t=>{let l=r.querySelector(t);if([].forEach((e=>{if(l.hasAttribute(e)&&"typeof"===e){let r=n.find((t=>t.name===l.getAttribute(e)));if(!r)throw new Error(`Type "${l.getAttribute(e)}" does not exist`);{let e,n=o[r.constraint],l=i.querySelector(t).innerHTML;if("false"===r.isStrict)return;if(n===Number){if(e=Number(l),e=isNaN(e)?0:e,0===e)throw new Error(`Invalid value for type "${r.name}": ${l} (expected number)`)}else if(n===Boolean)if("true"===l.toLowerCase())e=!0;else{if("false"!==l.toLowerCase())throw new Error(`Invalid value for type "${r.name}": ${l} (expected boolean)`);e=!1}else{if(n!==String)throw new Error(`Invalid constraint type for type "${r.name}": ${r.constraint}`);e=l}}}})),r.querySelector(t).hasAttribute("props")){r.querySelector(t).getAttribute("props").split(":").forEach((e=>{l.querySelectorAll("[derive]").forEach((e=>{let r=e.getAttribute("derive"),n=i.querySelector(t).getAttribute(r);e.innerHTML.includes(`{{${r}}}`)&&(e.innerHTML=e.innerHTML.replace(`{{${r}}}`,n))})),l.innerHTML.includes(`{{${e}}}`)&&(l.innerHTML=l.innerHTML.replace(`{{${e}}}`,i.querySelector(t).getAttribute(e)))}))}e.push({name:l.tagName,template:l.innerHTML});let s=i.querySelector(t);function a(){if(s){document.querySelector(s.tagName).innerHTML=s.innerHTML,r.querySelectorAll("import").forEach((e=>{let t=e.getAttribute("src");if(!t.endsWith(".html"))throw new Error("Unsupported imported file type!");fetch(t).then((e=>e.text())).then((t=>{let n=e.getAttribute("exports").split(","),o=(new DOMParser).parseFromString(t,"text/html");if(o.querySelectorAll("var").forEach((e=>{let t=e.getAttribute("name"),r=e.innerHTML;window[t]=r})),o.querySelectorAll("*").forEach((e=>{let t=e.innerHTML.match(/{{(.*?)}}/g);t&&t.forEach((t=>{let r=t.split("{{")[1].split("}}")[0];window.hasOwnProperty(r)&&(e.innerHTML=e.innerHTML.replace(`{{${r}}}`,window[r]))}))})),o.querySelector("export")){o.querySelector("export").innerHTML.split(",").forEach((e=>{let t=e.replace(/\s/g,"");n.forEach((e=>{if(e==t&&r.querySelector(t)){if(r.querySelector(t).innerHTML.includes("{{")){let e=r.querySelector(t).innerHTML.split("{{")[1].split("}}")[0];r.querySelector(t).innerHTML=window[e]}i.querySelector(t)&&o.querySelector(t)&&(document.querySelector(t).innerHTML=o.querySelector(t).innerHTML)}}))}))}}))}))}}s.innerHTML=l.innerHTML,a();let u=document.querySelector("meta[config]"),c=u.getAttribute("fallback"),d={};function h(){if(a(),d[window.location.hash]||(window.location.hash=c),s){let n=s?s.parentNode:null,o=r.querySelector(t);if(d[window.location.hash]=o.innerHTML,n&&n.hasAttribute("route")){let t=n.getAttribute("route"),r=n.getAttribute("position");t&&"first"===r?e(s,o,"first",n.getAttribute("route")):t&&"last"===r&&e(s,o,"last",n.getAttribute("route"))}else e(s,o,"first",c)}function e(e,t,r,n){let o;d[n]=t.innerHTML,o=!(n="#"+n),e.querySelectorAll("*").forEach((e=>{e.hasAttribute("route")&&(e.innerHTML="")})),n!==window.location.hash||o?s.innerHTML="":s.innerHTML=t.innerHTML}}u&&(u=u.getAttribute("routes"),u=u.split(","),u.forEach((e=>{d[`#${e}`]=`#${e}`}))),c="#"+c,d[window.location.hash]||(window.location.hash=c),h(),window.addEventListener("hashchange",(()=>{document.querySelector("html").setAttribute("root",window.location.hash.split("#")[1]),h()}))})))};document.addEventListener("DOMContentLoaded",(()=>{setTimeout((()=>{document.body.style.display="block"}),150)}));
