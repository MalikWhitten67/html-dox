let e=[],t=document.querySelector("imports");t.style.display="none";let r=t.innerHTML.replace(/\s/g,"");r=r.split(","),r=r.filter(Boolean);let n={};if(document.querySelector("script")&&!document.querySelector("script").getAttribute("src").includes("html-dox.js"))throw new Error("html-dox.js must be the last script tag in the body");if(document.querySelector("style"))throw new Error("Style tags are not supported in dox!");if(document.querySelector("link"))throw new Error("Link tags are not supported in dox!");document.body.style.display="none";let o=[],i={"dox:string":String,"dox:number":Number,"dox:boolean":Boolean,"dox:array":Array,"dox:object":Object,"dox:undefined":void 0,"dox:null":null,"dox:function":Function,"dox:regexp":RegExp,"dox:date":Date};function l(e,t,r,n){let o=n.getAttribute("exports").split(","),i=(new DOMParser).parseFromString(e,"text/html");if(i=i.querySelector("html"),i.querySelectorAll("*").forEach((e=>{if(e.hasAttribute("style")){let t=e.getAttribute("style").split(";");t.forEach((r=>{console.error(`Error in line ${t.indexOf(r)+1} conflicting styles embeded in dox are not supported at:\n                    ${e.innerHTML.split("<")[0]}`)}))}})),i.querySelectorAll("var").forEach((e=>{let t=e.getAttribute("name"),r=e.innerHTML;window[t]=r})),i.querySelectorAll("*").forEach((e=>{let t=e.innerHTML.match(/{{(.*?)}}/g);t&&t.forEach((t=>{let r=t.split("{{")[1].split("}}")[0];window.hasOwnProperty(r)&&(e.innerHTML=e.innerHTML.replace(`{{${r}}}`,window[r]))}))})),i.querySelector("export")){i.querySelector("export").innerHTML.split(",").forEach((e=>{let n=e.replace(/\s/g,"");o.forEach((e=>{if(e==n&&t.querySelector(n)){if(t.querySelector(n).innerHTML.includes("{{")){let e=t.querySelector(n).innerHTML.split("{{")[1].split("}}")[0];window.hasOwnProperty(e)&&(t.querySelector(n).innerHTML=window[e])}r.querySelector(n)&&i.querySelector(n)&&(r.querySelector(n).innerHTML=i.querySelector(n).innerHTML)}}))}))}}r.map((e=>{if(!e.endsWith(".html")&&!e.endsWith(".css")&&!e.endsWith(".js"))throw new Error("Unsupported imported file type!");if(e.endsWith(".html")){let t=document.createElement("link");t.setAttribute("rel","preload"),t.setAttribute("href",e),t.type="text/html",t.setAttribute("as","document"),document.querySelector("head").appendChild(t),n[e]?s(n[e]):fetch(e).then((e=>e.text())).then((t=>{n[e]=t,s(t)}))}else if(e.endsWith(".css")){let t=document.createElement("link");t.setAttribute("rel","preload"),t.setAttribute("href",e),t.type="text/css",t.setAttribute("as","style"),document.querySelector("head").appendChild(t);let r=document.createElement("style");if(n[e]){let t=document.createElement("style");t.innerHTML=n[e],document.querySelector("head").appendChild(t)}else fetch(e).then((e=>e.text())).then((t=>{n[e]=t,r.innerHTML=t,document.querySelector("head").appendChild(r)}))}else if(e.endsWith(".js")){let t=document.createElement("link");if(t.setAttribute("rel","preload"),t.setAttribute("href",e),t.type="text/javascript",t.setAttribute("as","script"),document.querySelector("head").appendChild(t),n[e]){new Function(n[e])()}else fetch(e).then((e=>e.text())).then((t=>{if(t.includes("import "))throw new Error('Import statements with the "from" keyword are not allowed. Use $import instead.');if(t.includes("export "))throw new Error("Export statements are not allowed. Use $export instead.");if(t.includes("document")&&!e.includes("tailwind.js"))throw new Error("Imported JS file cannot contain document. Use dox instead.");if((t.includes("innerHTML")||t.includes("innerText"))&&!e.endsWith("tailwind.js"))throw new Error("Use dox:text to return text and dox:$ to return HTML.");new Function(t)()}))}}));const s=t=>{let s=(new DOMParser).parseFromString(t,"text/html");s=s.querySelector("html");let a=document.querySelector("body"),u=[],c=s.querySelector("export");console.log(c);let d={querySelector:e=>{let t=document.querySelector(e)||s.querySelector(e);if(t){let e={getDescendants:()=>{let e=[],r=t=>{let n=t.children;for(let t=0;t<n.length;t++)e.push(n[t]),r(n[t])};return r(t),{forEach:r=>{e.forEach((n=>{r({id:n.id,class:n.className,text:n.innerText,setHtml:e=>{n.innerHTML=e},getItem:e=>n.querySelector(`#${e}`),getHtml:()=>n.innerHTML,getChildren:()=>{let e=[];return n.querySelectorAll("*").forEach((r=>{r.parentNode===t&&e.push(r)})),e},getAncestors:()=>{let e=[],t=n.parentNode;for(;t;)e.push(t),t=t.parentNode;return e},querySelector:t=>(e=e.filter((e=>e.matches(t))),e),fadeIn:e=>{n.style.opacity=0,n.style.transition=`opacity ${e}s`,n.style.opacity=1},fadeOut:e=>{n.style.opacity=1,n.style.transition=`opacity ${e}s`,n.style.opacity=0},on:(e,t)=>{n.addEventListener(e,t)},inject:e=>{n.innerHTML=e},state:e=>{let t=u.find((t=>t.name===e));if(t)return t.value;throw new Error(`State "${e}" does not exist`)},setState:(e,t)=>{let r=u.find((t=>t.name===e));r?r.value=t:u.push({name:e,value:t})},watch:(e,t)=>{let r=u.find((t=>t.name===e));if(!r)throw new Error(`State "${e}" does not exist`);t(r.value)}})}))},map:t=>{let r=[];return e.forEach((e=>{r.push(t(e))})),r},querySelector:e=>{d.querySelector(e)},querySelectorAll:t=>(e=e.filter((e=>e.matches(t))),e),inject:(e,t)=>{let r=document.querySelector(e);r&&(r.innerHTML=t)},html:()=>{let t="";return e.forEach((e=>{t+=e.outerHTML})),t},getAncestors:()=>{let e=[],r=t.parentNode;for(;r;)e.push(r),r=r.parentNode;return e}}},inject:(e,t)=>{let r=document.querySelector(e);r&&(r.innerHTML=t)},getAncestors:()=>{let e=[],r=t.parentNode;for(;r;)e.push(r),r=r.parentNode;return e},text:t.innerText,html:t.innerHTML,getChildren:()=>{let e=[];return t.querySelectorAll("*").forEach((r=>{r.parentNode===t&&e.push(r)})),e}};return e}return null},querySelectorAll:e=>{let t=document.querySelectorAll(e)||s.querySelectorAll(e);if(t){let e={forEach:e=>{t.forEach((r=>{e({id:r.id,class:r.className,text:r.innerText,html:r.innerHTML,getChildren:()=>{let e=[];return r.querySelectorAll("*").forEach((t=>{t.parentNode===el&&e.push(t)})),e},getAncestors:()=>{let e=[],t=r.parentNode;for(;t;)e.push(t),t=t.parentNode;return e},querySelector:e=>(t=t.filter((t=>t.matches(e))),t),fadeIn:e=>{r.style.opacity=0,r.style.transition=`opacity ${e}s`,r.style.opacity=1},fadeOut:e=>{r.style.opacity=1,r.style.transition=`opacity ${e}s`,r.style.opacity=0},on:(e,t)=>{r.addEventListener(e,t)},inject:e=>{r.innerHTML=e},state:e=>{let t=u.find((t=>t.name===e));if(t)return t.value;throw new Error(`State "${e}" does not exist`)},setState:(e,t)=>{let r=u.find((t=>t.name===e));r?r.value=t:u.push({name:e,value:t})},watch:(e,t)=>{let r=u.find((t=>t.name===e));if(!r)throw new Error(`State "${e}" does not exist`);t(r.value)}})}))},map:e=>{let r=[];return t.forEach((t=>{r.push(e(t))})),r},querySelector:e=>{d.querySelector(e)},querySelectorAll:e=>(t=t.filter((t=>t.matches(e))),t),inject:(e,t)=>{let r=document.querySelector(e);r&&(r.innerHTML=t)},getAncestors:()=>{let e=[],t=el.parentNode;for(;t;)e.push(t),t=t.parentNode;return e},text:el.innerText,html:el.innerHTML,getChildren:()=>{let e=[];return el.querySelectorAll("*").forEach((t=>{t.parentNode===el&&e.push(t)})),e}};return e}return null}};window.$import=e=>{if(!e.endsWith(".js"))return window[e];fetch(file).then((e=>e.text())).then((e=>{if(e.includes("import "))throw new Error('Import statements with the "from" keyword are not allowed. Use $import instead.');if(e.includes("export "))throw new Error("Export statements are not allowed. Use $export instead.");if(e.includes("document")&&!item.includes("tailwind.js"))throw new Error("Imported js file cannot contain document use dox instead");if(e.includes("innerHTML")||e.includes("innerText")&&!item.endsWith("tailwind.js"))throw new Error("use dox:text  to return text and dox:$ to return html");new Function(e)()}))},window.$export=(e,t)=>{window[e]=t},window.dox=d,a.querySelectorAll("type").forEach((e=>{let t=e.querySelectorAll("subtype");o.push({name:e.getAttribute("name"),constraint:e.getAttribute("constraint"),isStrict:e.getAttribute("isStrict")}),e.querySelectorAll("subtype").forEach((e=>{if(!i[e.getAttribute("constraint")])throw new Error("The constraint type does not exist");o.push({name:e.getAttribute("name"),constraint:e.getAttribute("constraint")})})),t.forEach((e=>{if(!i[e.getAttribute("constraint")])throw new Error("The constraint type does not exist");o.push({name:e.getAttribute("name"),constraint:e.getAttribute("constraint")})})),s.querySelectorAll("[subtype]").forEach((e=>{if(e.innerHTML.includes("{{")){let t=e.innerHTML.split("{{")[1].split("}}")[0];a.querySelectorAll(`[${t}]`).forEach((r=>{let n=r.getAttribute(t),l=e.getAttribute("subtype"),s=o.find((e=>e.name===l)),a=s.isStrict;if(s&&a){let e,t=i[s.constraint];if(t===Number){if(e=Number(n),e=isNaN(e)?0:e,0===e)throw new Error(`Invalid  value for subtype "${l}": ${n} (expected number)`)}else if(t===Boolean)if("true"===n.toLowerCase())e=!0;else{if("false"!==n.toLowerCase())throw new Error(`Invalid attribute value for subtype "${l}": ${n} (expected boolean)`);e=!1}else{if(t!==String)throw new Error(`Invalid constraint type for subtype "${l}": ${s.constraint}`);e=n}}}))}}))})),s.querySelectorAll("type").forEach((e=>{let t=e.querySelectorAll("subtype"),r=[];t.forEach((t=>{if(r.push(t.getAttribute("name")),r.filter(((e,t)=>r.indexOf(e)!==t)).length>0)throw new Error("Two subtypes cannot have the same name");if(t.getAttribute("name")===e.getAttribute("name"))throw new Error("Types and subtypes cannot have the same name")})),o.push({name:e.getAttribute("name"),constraint:e.getAttribute("constraint"),isStrict:e.getAttribute("isStrict")}),e.querySelectorAll("subtype").forEach((e=>{if(!i[e.getAttribute("constraint")])throw new Error("The constraint type does not exist");o.push({name:e.getAttribute("name"),constraint:e.getAttribute("constraint"),isStrict:e.getAttribute("isStrict")})})),s.querySelectorAll("[subtype]").forEach((e=>{if(e.innerHTML.includes("{{")){let t=e.innerHTML.split("{{")[1].split("}}")[0];a.querySelectorAll(`[${t}]`).forEach((r=>{let n=r.getAttribute(t),l=e.getAttribute("subtype"),s=o.find((e=>e.name===l)),a=s.isStrict;if(s&&a){let e,t=i[s.constraint];if(t===Number){if(e=Number(n),e=isNaN(e)?0:e,0===e)throw new Error(`Invalid  value for subtype "${l}": ${n} (expected number)`)}else if(t===Boolean)if("true"===n.toLowerCase())e=!0;else{if("false"!==n.toLowerCase())throw new Error(`Invalid attribute value for subtype "${l}": ${n} (expected boolean)`);e=!1}else{if(t!==String)throw new Error(`Invalid constraint type for subtype "${l}": ${s.constraint}`);e=n}}}))}}))})),s.querySelectorAll("var").forEach((e=>{let t=e.getAttribute("name"),r=e.innerHTML;window[t]=r})),s.querySelectorAll("*").forEach((e=>{let t=e.innerHTML.match(/{{(.*?)}}/g);t&&t.forEach((t=>{let r=t.split("{{")[1].split("}}")[0];window.hasOwnProperty(r)&&(e.innerHTML=e.innerHTML.replace(`{{${r}}}`,window[r]))}))})),c&&(c=c.innerHTML.replace(/\s/g,""),c=c.split(","),c=c.filter(Boolean),c.forEach((t=>{let u=s.querySelector(t);if([].forEach((e=>{if(u.hasAttribute(e)&&"typeof"===e){let r=o.find((t=>t.name===u.getAttribute(e)));if(!r)throw new Error(`Type "${u.getAttribute(e)}" does not exist`);{let e,n=i[r.constraint],o=a.querySelector(t).innerHTML;if("false"===r.isStrict)return;if(n===Number){if(e=Number(o),e=isNaN(e)?0:e,0===e)throw new Error(`Invalid value for type "${r.name}": ${o} (expected number)`)}else if(n===Boolean)if("true"===o.toLowerCase())e=!0;else{if("false"!==o.toLowerCase())throw new Error(`Invalid value for type "${r.name}": ${o} (expected boolean)`);e=!1}else{if(n!==String)throw new Error(`Invalid constraint type for type "${r.name}": ${r.constraint}`);e=o}}}})),s.querySelector(t).hasAttribute("props")){s.querySelector(t).getAttribute("props").split(":").forEach((e=>{u.querySelectorAll("[derive]").forEach((e=>{let r=e.getAttribute("derive"),n=a.querySelector(t).getAttribute(r);e.innerHTML.includes(`{{${r}}}`)&&(e.innerHTML=e.innerHTML.replace(`{{${r}}}`,n))})),u.innerHTML.includes(`{{${e}}}`)&&(u.innerHTML=u.innerHTML.replace(`{{${e}}}`,a.querySelector(t).getAttribute(e)))}))}e.push({name:u.tagName,template:u.innerHTML});let c=a.querySelector(t);function d(){if(c){document.querySelector(c.tagName).innerHTML=c.innerHTML,s.querySelectorAll("import").forEach((e=>{let t=e.getAttribute("src");if(!t.endsWith(".html"))throw new Error("Unsupported imported file type!");window[t]?l(window[t],s,a,e):fetch(t).then((e=>e.text())).then((r=>{window[t]=r,l(r,s,a,e)}))}))}}c.innerHTML=u.innerHTML;let h=document.querySelector("meta[config]"),p=h.getAttribute("fallback"),f={};function y(){if(d(),f[window.location.hash]||(window.location.hash=p),c){let r=c?c.parentNode:null,n=s.querySelector(t);if(f[window.location.hash]=n.innerHTML,r&&r.hasAttribute("route")){let t=r.getAttribute("route"),o=r.getAttribute("position");t&&"first"===o?e(c,n,"first",r.getAttribute("route")):t&&"last"===o&&e(c,n,"last",r.getAttribute("route"))}else e(c,n,"first",p)}function e(e,t,r,n){let o;f[n]=t.innerHTML,o=!(n="#"+n),e.querySelectorAll("*").forEach((e=>{e.hasAttribute("route")&&(e.innerHTML="")})),n!==window.location.hash||o?c.innerHTML="":c.innerHTML=t.innerHTML}}h&&(h=h.getAttribute("routes"),h=h.split(","),h.forEach((e=>{f[`#${e}`]=`#${e}`}))),p="#"+p,f[window.location.hash]||(window.location.hash=p),y(),window.addEventListener("hashchange",(()=>{document.querySelector("html").setAttribute("root",window.location.hash.split("#")[1]),y(),r.map((e=>{e.endsWith(".js")&&(n[e]?new Function(n[e])():fetch(e).then((e=>e.text())).then((t=>{if(t.includes("import "))throw new Error('Import statements with the "from" keyword are not allowed. Use $import instead.');if(t.includes("export "))throw new Error("Export statements are not allowed. Use $export instead.");if(t.includes("document")&&!e.includes("tailwind.js"))throw new Error("Imported JS file cannot contain document. Use dox instead.");if((t.includes("innerHTML")||t.includes("innerText"))&&!e.endsWith("tailwind.js"))throw new Error("Use dox:text to return text and dox:$ to return HTML.");new Function(t)()})))})),d()}))})))};document.addEventListener("DOMContentLoaded",(()=>{setTimeout((()=>{document.body.style.display="block"}),150)}));